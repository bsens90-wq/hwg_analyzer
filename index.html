<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>보장분석 앱</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,">
  <style>
    :root{
      --primary:#ff7f00;
      --primary-dark:#e67100;
      --bg:#f8f9fa;
      --card:#ffffff;
      --text:#333;
      --muted:#777;
      --border:#e6e6e6;
      --success:#28a745;
      --danger:#dc3545;
    }
    
    *{box-sizing:border-box}
    
    body{
      margin:0;
      padding-top: 70px;
      font-family: Arial, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    
    .header-fixed {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      background: var(--bg);
      border-bottom: 2px solid #ccc;
      padding: 8px 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,.08);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .header-center {
      flex: 1;
      text-align: center;
    }
    
    .logo-container {
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-block;
    }
    
    .logo-main {
      font-size: 28px;
      font-weight: 900;
      color: var(--primary);
      letter-spacing: 2px;
      text-shadow: 0 2px 4px rgba(255,127,0,0.2);
      margin: 0;
      line-height: 1;
    }
    
    .screen{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      padding:2rem 1rem;
    }
    
    .app-title{
      font-size:24px;
      font-weight:700;
      color:var(--primary);
      margin-bottom:2rem;
      text-align:center;
    }
    
    .card{
      width:100%;
      max-width:520px;
      background:var(--card);
      border-radius:16px;
      box-shadow:0 6px 18px rgba(0,0,0,.08);
      padding:20px;
    }
    
    .card-wide{
      max-width:800px;
    }
    
    h2{margin:0 0 1rem 0; font-size:20px;}
    
    .menu-btn{
      width:100%;
      padding:16px 20px;
      background:var(--primary);
      color:#fff;
      border:none;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
      font-size:18px;
      margin-bottom:12px;
      transition: all 0.2s ease;
    }
    
    .menu-btn:hover{background:var(--primary-dark)}
    
    .secondary-btn{
      background:#6c757d;
      font-size:16px;
      padding:12px 16px;
    }
    
    .secondary-btn:hover{background:#545b62}
    
    .input-section{
      margin-bottom:1.5rem;
    }
    
    .section-title{
      font-size:18px;
      font-weight:700;
      color:var(--primary);
      margin-bottom:1rem;
      text-align:center;
      border-bottom:2px solid var(--primary);
      padding-bottom:8px;
    }
    
    .input-grid{
      display:grid;
      grid-template-columns:1fr 120px;
      gap:8px;
      margin-bottom:8px;
      align-items:center;
    }
    
    .input-label{
      font-size:14px;
      font-weight:600;
      color:var(--text);
      background:#f8f9fa;
      padding:8px 12px;
      border-radius:8px;
      border:1px solid var(--border);
    }
    
    .input-field{
      padding:8px 12px;
      border:1px solid var(--border);
      border-radius:8px;
      font-size:14px;
      outline:none;
      background:#fff;
      text-align:center;
    }
    
    .input-field:focus{border-color:var(--primary)}
    
    .select-field{
      padding:8px 12px;
      border:1px solid var(--border);
      border-radius:8px;
      font-size:14px;
      outline:none;
      background:#fff;
      text-align:center;
    }
    
    .example-section{
      background:#fff3cd;
      border:1px solid #ffeaa7;
      border-radius:8px;
      padding:12px;
      margin-bottom:1.5rem;
    }
    
    .example-title{
      font-size:16px;
      font-weight:600;
      margin-bottom:8px;
      color:#856404;
    }
    
    .example-grid{
      display:grid;
      grid-template-columns:1fr auto;
      gap:8px;
      margin-bottom:6px;
      align-items:center;
    }
    
    .example-label{
      font-size:13px;
      color:#856404;
    }
    
    .example-value{
      font-size:13px;
      font-weight:600;
      color:#856404;
      text-align:right;
    }
    
    .insurance-section{
      background:#d1ecf1;
      border:1px solid #bee5eb;
      border-radius:8px;
      padding:12px;
      margin-bottom:1.5rem;
    }
    
    .insurance-title{
      font-size:16px;
      font-weight:600;
      margin-bottom:12px;
      color:#0c5460;
      text-align:center;
    }
    
    .insurance-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(80px, 1fr));
      gap:8px;
      margin-bottom:12px;
    }
    
    .insurance-item{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:4px;
    }
    
    .insurance-label{
      font-size:12px;
      color:#0c5460;
      text-align:center;
      line-height:1.3;
    }
    
    .limit-grid{
      display:grid;
      grid-template-columns:1fr 80px;
      gap:8px;
      margin-bottom:6px;
      align-items:center;
    }
    
    .save-btn{
      width:100%;
      padding:16px 20px;
      background:var(--success);
      color:#fff;
      border:none;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
      font-size:18px;
      margin-top:20px;
    }
    
    .save-btn:hover{background:#218838}
    
    .customer-input{
      margin-bottom:20px;
    }
    
    .customer-input input{
      width:100%;
      padding:12px 16px;
      border:1px solid var(--border);
      border-radius:8px;
      font-size:16px;
      outline:none;
      background:#fff;
      text-align:center;
      font-weight:600;
    }
    
    .saved-list{
      margin-top:1rem;
    }
    
    .saved-item{
      background:#fff;
      border:1px solid var(--border);
      border-radius:8px;
      padding:12px;
      margin-bottom:8px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      cursor:pointer;
      transition: all 0.2s ease;
    }
    
    .saved-item:hover{
      background:#f8f9fa;
      transform:translateY(-1px);
    }
    
    .saved-info{
      flex:1;
    }
    
    .saved-name{
      font-weight:600;
      font-size:16px;
      margin-bottom:4px;
    }
    
    .saved-date{
      font-size:12px;
      color:var(--muted);
    }
    
    .delete-btn{
      background:var(--danger);
      color:#fff;
      border:none;
      border-radius:6px;
      padding:6px 12px;
      font-size:12px;
      cursor:pointer;
      font-weight:600;
    }
    
    .delete-btn:hover{background:#c82333}
    
    .meta{
      margin-top:1rem;
      font-size:12px;
      color:var(--muted);
      text-align:center;
    }
    
    /* 출력용 스타일 */
    .print-container{
      background:#fff;
      padding:20px;
      margin:20px;
      font-family: Arial, sans-serif;
      color:#000;
    }
    
    .print-header{
      text-align:center;
      font-size:20px;
      font-weight:bold;
      margin-bottom:20px;
      color:#ff7f00;
    }
    
    .print-section{
      margin-bottom:20px;
      border:1px solid #ddd;
      border-radius:8px;
      overflow:hidden;
    }
    
    .print-section-title{
      background:#ff7f00;
      color:#fff;
      padding:10px;
      font-weight:bold;
      text-align:center;
    }
    
    .print-grid{
      display:grid;
      grid-template-columns:1fr 120px;
      border-bottom:1px solid #eee;
    }
    
    .print-grid:last-child{
      border-bottom:none;
    }
    
    .print-label{
      padding:8px 12px;
      background:#f8f9fa;
      border-right:1px solid #eee;
      font-weight:600;
    }
    
    .print-value{
      padding:8px 12px;
      text-align:center;
      font-weight:bold;
      color:#ff7f00;
    }
    
    .print-example-section{
      background:#fff3cd;
      border:1px solid #ffeaa7;
      margin:10px;
      border-radius:8px;
    }
    
    .print-example-title{
      background:#f0c674;
      padding:8px;
      font-weight:bold;
      text-align:center;
      color:#333;
    }
    
    .print-insurance-section{
      background:#d1ecf1;
      border:1px solid #bee5eb;
      margin:10px;
      border-radius:8px;
    }
    
    .print-insurance-title{
      background:#17a2b8;
      color:#fff;
      padding:8px;
      font-weight:bold;
      text-align:center;
    }
    
    .print-insurance-grid{
      display:grid;
      grid-template-columns:repeat(4, 1fr);
      gap:8px;
      padding:10px;
    }
    
    .print-insurance-item{
      text-align:center;
      padding:4px;
      border:1px solid #bee5eb;
      border-radius:4px;
      background:#fff;
    }
    
    .print-footer{
      text-align:center;
      font-size:12px;
      color:#666;
      margin-top:20px;
      border-top:1px solid #ddd;
      padding-top:10px;
    }
    
    @media (max-width: 768px) {
      body{
        padding-top: 60px;
      }
      
      .header-fixed{
        padding: 6px 15px;
      }
      
      .logo-main{
        font-size: 24px;
      }
      
      .card{
        max-width:100%;
        margin:0 10px;
        padding:15px;
      }
      
      .input-grid{
        grid-template-columns:1fr 100px;
        gap:6px;
      }
      
      .input-label, .input-field{
        font-size:13px;
        padding:6px 10px;
      }
      
      .insurance-grid{
        grid-template-columns:repeat(4, 1fr);
        gap:6px;
      }
      
      .insurance-label{
        font-size:11px;
      }
      
      .print-container{
        margin:10px;
        padding:15px;
      }
      
      .print-grid{
        grid-template-columns:1fr 100px;
      }
      
      .print-insurance-grid{
        grid-template-columns:repeat(2, 1fr);
      }
    }
  </style>
  <script>
    let currentScreen = 'menu';

    // 화면 전환 함수들을 먼저 정의
    function hideAllScreens() {
      const menuScreen = document.getElementById("menuScreen");
      const inputScreen = document.getElementById("inputScreen");
      const loadScreen = document.getElementById("loadScreen");
      
      if (menuScreen) menuScreen.style.display = "none";
      if (inputScreen) inputScreen.style.display = "none";
      if (loadScreen) loadScreen.style.display = "none";
    }

    function showInputScreen() {
      hideAllScreens();
      const inputScreen = document.getElementById("inputScreen");
      if (inputScreen) {
        inputScreen.style.display = "flex";
        currentScreen = 'input';
        
        setTimeout(() => {
          addInputListeners();
          updateExamples();
        }, 100);
      }
    }

    function showLoadScreen() {
      hideAllScreens();
      const loadScreen = document.getElementById("loadScreen");
      if (loadScreen) {
        loadScreen.style.display = "flex";
        currentScreen = 'load';
        setTimeout(() => {
          loadSavedAnalyses();
        }, 100);
      }
    }

    function goHome() {
      hideAllScreens();
      const menuScreen = document.getElementById("menuScreen");
      if (menuScreen) {
        menuScreen.style.display = "flex";
        currentScreen = 'menu';
      }
    }

    // 입력 필드 이벤트 리스너
    function addInputListeners() {
      const inputFields = document.querySelectorAll('.input-field[type="number"]');
      inputFields.forEach(field => {
        field.addEventListener('input', updateExamples);
      });
    }

    // 예시 계산 업데이트
    function updateExamples() {
      // 요소 존재 확인
      const robotSurgeryEl = document.getElementById('example_robot_surgery');
      const metastaticTargetedEl = document.getElementById('example_metastatic_targeted');
      const heavyIonEl = document.getElementById('example_heavy_ion');
      const stentEl = document.getElementById('example_stent');
      const stentThrombolysisEl = document.getElementById('example_stent_thrombolysis');
      const comprehensiveEl = document.getElementById('example_comprehensive');
      
      // 다빈치로봇수술 = 암수술비 + 다빈치로봇수술비
      const robotSurgery = (getValue('cancer_surgery') || 0) + (getValue('cancer_robot_surgery') || 0);
      if (robotSurgeryEl) robotSurgeryEl.textContent = robotSurgery + '만원';
      
      // 1개 부위 전이+표적 = 전이암진단비 + 표적항암치료비
      const metastaticTargeted = (getValue('cancer_metastatic') || 0) + (getValue('cancer_targeted') || 0);
      if (metastaticTargetedEl) metastaticTargetedEl.textContent = metastaticTargeted + '만원';
      
      // 중입자치료 = 중입자치료비
      const heavyIon = getValue('cancer_heavy_ion') || 0;
      if (heavyIonEl) heavyIonEl.textContent = heavyIon + '만원';
      
      // 스텐트 = 주요순환계(수술)
      const stent = getValue('circulatory_surgery') || 0;
      if (stentEl) stentEl.textContent = stent + '만원';
      
      // 스텐트+혈전용해 = 주요순환계(수술) + 주요순환계(혈전용해)
      const stentThrombolysis = (getValue('circulatory_surgery') || 0) + (getValue('circulatory_thrombolysis') || 0);
      if (stentThrombolysisEl) stentThrombolysisEl.textContent = stentThrombolysis + '만원';
      
      // 혈전용해+혈전제거+중환자실 = 주요순환계(혈전용해) + 주요순환계(혈전제거) + 주요순환계(중환자실)
      const comprehensive = (getValue('circulatory_thrombolysis') || 0) + 
                           (getValue('circulatory_thrombectomy') || 0) + 
                           (getValue('circulatory_icu') || 0);
      if (comprehensiveEl) comprehensiveEl.textContent = comprehensive + '만원';
    }

    // 입력값 가져오기 헬퍼 함수
    function getValue(fieldId) {
      const field = document.getElementById(fieldId);
      return field ? parseInt(field.value) || 0 : 0;
    }

    function getTextValue(fieldId) {
      const field = document.getElementById(fieldId);
      return field ? field.value || '' : '';
    }

    function getSelectValue(fieldId) {
      const field = document.getElementById(fieldId);
      return field ? field.value || '' : '';
    }

    // 분석 저장
    function saveAnalysis() {
      const customerName = document.getElementById('customerName').value.trim();
      
      if (!customerName) {
        alert('고객명을 입력해주세요.');
        return;
      }
      
      // 모든 입력값 수집
      const analysisData = {
        customerName: customerName,
        timestamp: new Date().toISOString(),
        data: {
          // 암 보장
          cancer_general: getValue('cancer_general'),
          cancer_integrated: getValue('cancer_integrated'),
          cancer_metastatic: getValue('cancer_metastatic'),
          cancer_treatment: getValue('cancer_treatment'),
          cancer_treatment_non: getValue('cancer_treatment_non'),
          cancer_targeted: getValue('cancer_targeted'),
          cancer_heavy_ion: getValue('cancer_heavy_ion'),
          cancer_surgery: getValue('cancer_surgery'),
          cancer_robot_surgery: getValue('cancer_robot_surgery'),
          cancer_surgery_5type: getValue('cancer_surgery_5type'),
          
          // 뇌 관련
          brain_diagnosis: getValue('brain_diagnosis'),
          stroke_diagnosis: getValue('stroke_diagnosis'),
          
          // 심장 관련
          heart_ischemic_diagnosis: getValue('heart_ischemic_diagnosis'),
          heart_infarction_diagnosis: getValue('heart_infarction_diagnosis'),
          
          // 치료비
          major2_treatment: getValue('major2_treatment'),
          circulatory_surgery: getValue('circulatory_surgery'),
          circulatory_thrombectomy: getValue('circulatory_thrombectomy'),
          circulatory_thrombolysis: getValue('circulatory_thrombolysis'),
          circulatory_icu: getValue('circulatory_icu'),
          thrombectomy_treatment: getValue('thrombectomy_treatment'),
          thrombolysis_treatment: getValue('thrombolysis_treatment'),
          brain_heart_surgery: getValue('brain_heart_surgery'),
          surgery_3type: getValue('surgery_3type'),
          surgery_5type: getValue('surgery_5type'),
          disease_124_surgery: getValue('disease_124_surgery'),
          organ_7_surgery: getValue('organ_7_surgery'),
          
          // 5대 필수 보험
          medical_insurance: getSelectValue('medical_insurance'),
          fire_insurance: getSelectValue('fire_insurance'),
          driver_insurance: getSelectValue('driver_insurance'),
          liability_insurance: getSelectValue('liability_insurance'),
          caregiver_insurance: getSelectValue('caregiver_insurance'),
          
          // 한도
          disease_inpatient_limit: getTextValue('disease_inpatient_limit'),
          disease_outpatient_limit: getTextValue('disease_outpatient_limit'),
          injury_inpatient_limit: getTextValue('injury_inpatient_limit'),
          injury_outpatient_limit: getTextValue('injury_outpatient_limit'),
          criminal_settlement: getTextValue('criminal_settlement'),
          lawyer_fee: getTextValue('lawyer_fee'),
          
          // 보험료
          insurance_premium: getValue('insurance_premium')
        }
      };
      
      // 로컬 스토리지에 저장
      const savedAnalyses = JSON.parse(localStorage.getItem('coverageAnalyses') || '[]');
      const analysisId = Date.now().toString();
      analysisData.id = analysisId;
      
      savedAnalyses.push(analysisData);
      localStorage.setItem('coverageAnalyses', JSON.stringify(savedAnalyses));
      
      // 이미지 생성 및 다운로드
      generateAndDownloadImage(analysisData);
      
      alert(`${customerName}님의 보장분석이 저장되었습니다.`);
    }

    // 이미지 생성 및 다운로드
    function generateAndDownloadImage(analysisData) {
      // Canvas 생성
      const canvas = document.createElement('canvas');
      canvas.width = 800;
      canvas.height = 1200;
      const ctx = canvas.getContext('2d');
      
      // 배경색
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // 헤더
      ctx.fillStyle = '#ff7f00';
      ctx.font = 'bold 24px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(`${analysisData.customerName}님의 한 장 요약 보장분석`, canvas.width/2, 50);
      
      let y = 100;
      
      // 암 보장 섹션
      drawSection(ctx, '암 보장', y);
      y += 40;
      
      const cancerItems = [
        ['일반암진단비', analysisData.data.cancer_general],
        ['통합암진단비', analysisData.data.cancer_integrated],
        ['전이암진단비', analysisData.data.cancer_metastatic],
        ['암특정치료비', analysisData.data.cancer_treatment],
        ['암특정치료비(비급여)', analysisData.data.cancer_treatment_non],
        ['표적항암치료비', analysisData.data.cancer_targeted],
        ['중입자치료비', analysisData.data.cancer_heavy_ion],
        ['암수술비', analysisData.data.cancer_surgery],
        ['다빈치로봇수술비', analysisData.data.cancer_robot_surgery],
        ['1-5종수술비(5종)', analysisData.data.cancer_surgery_5type]
      ];
      
      cancerItems.forEach(([label, value]) => {
        drawItem(ctx, label, value, y);
        y += 25;
      });
      
      y += 20;
      
      // 2대 중대질환 섹션
      drawSection(ctx, '2대 중대질환', y);
      y += 40;
      
      const majorDiseaseItems = [
        ['뇌혈관질환 진단비', analysisData.data.brain_diagnosis],
        ['뇌졸중 진단비', analysisData.data.stroke_diagnosis],
        ['허혈성심장질환 진단비', analysisData.data.heart_ischemic_diagnosis],
        ['급성심근경색 진단비', analysisData.data.heart_infarction_diagnosis],
        ['2대특정치료비', analysisData.data.major2_treatment],
        ['주요순환계(수술)', analysisData.data.circulatory_surgery],
        ['주요순환계(혈전제거)', analysisData.data.circulatory_thrombectomy],
        ['주요순환계(혈전용해)', analysisData.data.circulatory_thrombolysis],
        ['주요순환계(중환자실)', analysisData.data.circulatory_icu]
      ];
      
      majorDiseaseItems.forEach(([label, value]) => {
        drawItem(ctx, label, value, y);
        y += 25;
      });
      
      y += 20;
      
      // 5대 필수 보험
      drawSection(ctx, '5대 필수 보험', y);
      y += 40;
      
      const insuranceItems = [
        ['실손의료비', analysisData.data.medical_insurance],
        ['화재보험', analysisData.data.fire_insurance],
        ['운전자', analysisData.data.driver_insurance],
        ['일상생활배상책임', analysisData.data.liability_insurance],
        ['간병인일당', analysisData.data.caregiver_insurance]
      ];
      
      insuranceItems.forEach(([label, value]) => {
        drawItem(ctx, label, value, y);
        y += 25;
      });
      
      // 보험료
      y += 20;
      drawItem(ctx, '월 보험료', analysisData.data.insurance_premium + '만원', y);
      
      // 푸터
      ctx.fillStyle = '#666666';
      ctx.font = '12px Arial';
      ctx.textAlign = 'center';
      const date = new Date(analysisData.timestamp).toLocaleString('ko-KR');
      ctx.fillText(`생성일시: ${date}`, canvas.width/2, canvas.height - 20);
      
      // 이미지 다운로드
      const link = document.createElement('a');
      link.download = `${analysisData.customerName}_보장분석_${new Date().toISOString().slice(0,10)}.png`;
      link.href = canvas.toDataURL();
      link.click();
    }
    
    function drawSection(ctx, title, y) {
      ctx.fillStyle = '#ff7f00';
      ctx.fillRect(50, y - 20, 700, 30);
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 16px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(title, 400, y);
    }
    
    function drawItem(ctx, label, value, y) {
      // 라벨 배경
      ctx.fillStyle = '#f8f9fa';
      ctx.fillRect(50, y - 15, 500, 20);
      ctx.strokeStyle = '#e6e6e6';
      ctx.strokeRect(50, y - 15, 500, 20);
      
      // 값 배경
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(550, y - 15, 200, 20);
      ctx.strokeRect(550, y - 15, 200, 20);
      
      // 텍스트
      ctx.fillStyle = '#333333';
      ctx.font = '14px Arial';
      ctx.textAlign = 'left';
      ctx.fillText(label, 60, y);
      
      ctx.fillStyle = '#ff7f00';
      ctx.font = 'bold 14px Arial';
      ctx.textAlign = 'center';
      const displayValue = (typeof value === 'number' && value > 0) ? value + '만원' : 
                          (value && value !== '' && value !== '0') ? value : '-';
      ctx.fillText(displayValue, 650, y);
    }

    // 저장된 분석 불러오기
    function loadSavedAnalyses() {
      const savedAnalyses = JSON.parse(localStorage.getItem('coverageAnalyses') || '[]');
      const listElement = document.getElementById('savedAnalysisList');
      
      if (!listElement) {
        console.error('savedAnalysisList 요소를 찾을 수 없습니다.');
        return;
      }
      
      if (savedAnalyses.length === 0) {
        listElement.innerHTML = '<div class="hint" style="text-align:center; color:#666; padding:20px;">저장된 분석이 없습니다.</div>';
        return;
      }
      
      // 최신 순으로 정렬
      savedAnalyses.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      listElement.innerHTML = savedAnalyses.map(analysis => {
        const date = new Date(analysis.timestamp).toLocaleString('ko-KR');
        return `
          <div class="saved-item" onclick="loadAnalysis('${analysis.id}')">
            <div class="saved-info">
              <div class="saved-name">${analysis.customerName}</div>
              <div class="saved-date">${date}</div>
            </div>
            <button class="delete-btn" onclick="event.stopPropagation(); deleteAnalysis('${analysis.id}')">삭제</button>
          </div>
        `;
      }).join('');
    }

    // 특정 분석 불러오기
    function loadAnalysis(analysisId) {
      const savedAnalyses = JSON.parse(localStorage.getItem('coverageAnalyses') || '[]');
      const analysis = savedAnalyses.find(a => a.id === analysisId);
      
      if (!analysis) {
        alert('해당 분석을 찾을 수 없습니다.');
        return;
      }
      
      // 입력 화면으로 이동
      showInputScreen();
      
      // 모든 값 설정
      setTimeout(() => {
        document.getElementById('customerName').value = analysis.customerName;
        
        Object.keys(analysis.data).forEach(key => {
          const field = document.getElementById(key);
          if (field) {
            field.value = analysis.data[key] || '';
          }
        });
        
        // 예시 업데이트
        updateExamples();
        
        alert(`${analysis.customerName}님의 분석을 불러왔습니다.`);
      }, 100);
    }

    // 분석 삭제
    function deleteAnalysis(analysisId) {
      if (!confirm('정말로 삭제하시겠습니까?')) {
        return;
      }
      
      const savedAnalyses = JSON.parse(localStorage.getItem('coverageAnalyses') || '[]');
      const filteredAnalyses = savedAnalyses.filter(a => a.id !== analysisId);
      
      localStorage.setItem('coverageAnalyses', JSON.stringify(filteredAnalyses));
      loadSavedAnalyses();
      
      alert('삭제되었습니다.');
    }
  </script>
</head>
<body>
  <div class="header-fixed">
    <div></div>
    <div class="header-center">
      <div class="logo-container" onclick="goHome()">
        <div class="logo-main">보장분석</div>
      </div>
    </div>
    <div></div>
  </div>

  <!-- 메뉴 화면 -->
  <section id="menuScreen" class="screen">
    <div class="app-title">보장분석 도구</div>
    <div class="card">
      <h2 style="margin-bottom:1.5rem; text-align:center;">메뉴 선택</h2>
      
      <button class="menu-btn" onclick="showInputScreen()">
        <span style="display:block; margin-bottom:4px;">입력하기</span>
        <span style="font-size:14px; opacity:0.8;">새로운 보장분석 작성</span>
      </button>
      
      <button class="menu-btn" onclick="showLoadScreen()">
        <span style="display:block; margin-bottom:4px;">불러오기</span>
        <span style="font-size:14px; opacity:0.8;">저장된 분석 불러오기</span>
      </button>
      
      <div class="meta" style="margin-top:2rem;">Copyright 2025 보장분석앱 all rights reserved.</div>
    </div>
  </section>

  <!-- 입력 화면 -->
  <section id="inputScreen" class="screen" style="display:none;">
    <div class="app-title">보장분석 입력</div>
    <div class="card card-wide">
      
      <!-- 고객명 입력 -->
      <div class="customer-input">
        <input id="customerName" type="text" placeholder="고객명을 입력해주세요" maxlength="20">
      </div>
      
      <!-- 암 보장 섹션 -->
      <div class="input-section">
        <div class="section-title">암 보장</div>
        
        <div class="input-grid">
          <div class="input-label">일반암진단비</div>
          <input class="input-field" id="cancer_general" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">통합암진단비</div>
          <input class="input-field" id="cancer_integrated" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">전이암진단비</div>
          <input class="input-field" id="cancer_metastatic" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">암특정치료비</div>
          <input class="input-field" id="cancer_treatment" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">암특정치료비(비급여)</div>
          <input class="input-field" id="cancer_treatment_non" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">표적항암치료비</div>
          <input class="input-field" id="cancer_targeted" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">중입자치료비</div>
          <input class="input-field" id="cancer_heavy_ion" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">암수술비</div>
          <input class="input-field" id="cancer_surgery" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">다빈치로봇수술비</div>
          <input class="input-field" id="cancer_robot_surgery" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">1-5종수술비(5종)</div>
          <input class="input-field" id="cancer_surgery_5type" type="number" placeholder="금액" min="0">
        </div>
      </div>
      
      <!-- 2대 중대질환 섹션 -->
      <div class="input-section">
        <div class="section-title">2대 중대질환</div>
        
        <!-- 뇌 관련 -->
        <div style="background:#f8f9fa; padding:8px; border-radius:6px; margin-bottom:8px; text-align:center; font-weight:600; font-size:14px;">뇌 관련 보장</div>
        
        <div class="input-grid">
          <div class="input-label">뇌혈관질환 진단비</div>
          <input class="input-field" id="brain_diagnosis" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">뇌졸중 진단비</div>
          <input class="input-field" id="stroke_diagnosis" type="number" placeholder="금액" min="0">
        </div>
        
        <!-- 심장 관련 -->
        <div style="background:#f8f9fa; padding:8px; border-radius:6px; margin-bottom:8px; margin-top:12px; text-align:center; font-weight:600; font-size:14px;">심장 관련 보장</div>
        
        <div class="input-grid">
          <div class="input-label">허혈성심장질환 진단비</div>
          <input class="input-field" id="heart_ischemic_diagnosis" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">급성심근경색 진단비</div>
          <input class="input-field" id="heart_infarction_diagnosis" type="number" placeholder="금액" min="0">
        </div>
        
        <!-- 공통 치료비 -->
        <div style="background:#f8f9fa; padding:8px; border-radius:6px; margin-bottom:8px; margin-top:12px; text-align:center; font-weight:600; font-size:14px;">치료비</div>
        
        <div class="input-grid">
          <div class="input-label">2대특정치료비</div>
          <input class="input-field" id="major2_treatment" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">주요순환계(수술)</div>
          <input class="input-field" id="circulatory_surgery" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">주요순환계(혈전제거)</div>
          <input class="input-field" id="circulatory_thrombectomy" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">주요순환계(혈전용해)</div>
          <input class="input-field" id="circulatory_thrombolysis" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">주요순환계(중환자실)</div>
          <input class="input-field" id="circulatory_icu" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">혈전제거치료비</div>
          <input class="input-field" id="thrombectomy_treatment" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">혈전용해치료비(뇌/심)</div>
          <input class="input-field" id="thrombolysis_treatment" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">수술비(뇌/심)</div>
          <input class="input-field" id="brain_heart_surgery" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">1-5종수술비(3종)</div>
          <input class="input-field" id="surgery_3type" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">1-5종수술비(5종)</div>
          <input class="input-field" id="surgery_5type" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">124대질병수술비(특정10대)</div>
          <input class="input-field" id="disease_124_surgery" type="number" placeholder="금액" min="0">
        </div>
        
        <div class="input-grid">
          <div class="input-label">7대기관수술비(뇌/심) 관혈</div>
          <input class="input-field" id="organ_7_surgery" type="number" placeholder="금액" min="0">
        </div>
      </div>
      
      <!-- 치료 보장 예시 -->
      <div class="example-section">
        <div class="example-title">일반암 치료 보장 예시</div>
        
        <div class="example-grid">
          <div class="example-label">다빈치로봇수술</div>
          <div class="example-value" id="example_robot_surgery">0만원</div>
        </div>
        
        <div class="example-grid">
          <div class="example-label">1개 부위 전이+표적</div>
          <div class="example-value" id="example_metastatic_targeted">0만원</div>
